<!DOCTYPE html>

<!--

    Copyright (c) Carlos Tojal (carlostojal)
    Foz do Arelho
    estatistica/questionario/index.php
    github.com/carlostojal/TSI

-->

<!-- Responder ao formulário -->

<html>
    <head>
        <!-- Scripts Google Analytics-->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-150584043-1"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-150584043-1');
        </script>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
            <title> Login - Questionário - Foz do Arelho </title>
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway&display=swap">
            <link rel="stylesheet" href="../../styles.css">
            <!-- Bootstrap -->
            <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
            <!-- Scripts JS relativos à meteorologia -->
            <script type="text/javascript" src="../scripts/weather.js"></script>
            <script type="text/javascript" src="../scripts/forecast.js"></script>
            <script src="https://apis.google.com/js/platform.js" async defer></script>
            <meta name="google-signin-client_id" content="625171640763-fhbniivukjgo3an4b64l9bftobkt2ti2.apps.googleusercontent.com">
    </head>
    <body>
        <!-- Contém todo o cabeçalho da página -->
        <header>
            <div class="title_header">
                <!-- Título grande -->
                <h1 class="title"> Login - Questionário </h1>

                <!-- Itens do menu -->
                <nav class="menu">
                    <a class="menu_items" href="../../"> INÍCIO </a>
                    <a class="menu_items" href="../../onde-ficar"> ONDE FICAR </a>
                    <a class="menu_items" href="../../o-que-fazer">O QUE FAZER </a>
                    <a class="menu_items" href="../../previsao"> PREVISÃO METEOROLÓGICA </a>
                    <a class="menu_items" href=".."> ESTATÍSTICA </a>
                    <a class="menu_items" href="../../contatos"> CONTATOS </a>
                    <a class="menu_items" href="../../statistic/questionnaire"> EN </a>
                </nav>
            </div>
        </header>
        <section>
            <div class="g-signin2" data-onsuccess="onSignIn"></div>
            <div id="test"></div>
            <script>
                function onSignIn(googleUser) {
                    var profile = googleUser.getBasicProfile();
                    console.log('ID: ' + profile.getId());
                    console.log('Name: ' + profile.getName());
                    console.log('Image URL: ' + profile.getImageUrl());
                    console.log('Email: ' + profile.getEmail());

                    login(profile.getId());
                }

                function login(id) {
                    var xhttp = new XMLHttpRequest();
                    xhttp.onreadystatechange = function() {
                        if (this.readyState == 4 && this.status == 200) {
                            if(this.responseText == "ok")
                                window.location.href = "../questionario/?id=" + profile.getId() + "&name=" + profile.getName() + "&email=" + profile.getEmail() + "&photo_url=" + profile.getImageUrl(); 
                        }
                    };
                    xhttp.open("POST", "login.php", true);
                    xhttp.send("id=" + id);
                }
            </script>             
        </section>
        <!-- Fundo da página que contém dados do desenvolvedor -->
        <footer>
            Desenvolvido por Carlos Tojal<br>
            <div class="contacts">
                GitHub: <a href="https://github.com/carlostojal" target="blank">carlostojal</a><br>
                Email: <a href="mailto:carlos.tojal@hotmail.com" target="blank">carlos.tojal@hotmail.com</a>
            </div><br>
            <div class="copyright">Copyright © Carlos Tojal (2019)</div>
        </footer>
    </body>
</html>
