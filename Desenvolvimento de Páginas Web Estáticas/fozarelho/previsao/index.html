<!DOCTYPE html>

<!--

    Copyright (c) Carlos Tojal (carlostojal)
    Foz do Arelho
    previsao/index.html

-->

<!-- Previsão meteorológica -->

<html>
    <head>
        <meta charset="UTF-8">
        <title> Previsão Meteorológica - Foz do Arelho </title>
    </head>
    <body>
        <header>
            <h1>Previsão Meteorológica</h1>
            <script type="text/javascript" src="../scripts/forecast.js"></script>
        </header>
        <nav>
            <ul>
                <li><a href=".."> Início </a></li>
                <li><a href="."> Previsão Meteorológica </a></li>
            </ul>
        </nav>
        <section>
            <div id="day1"></div><br>
            <div id="day2"></div><br>
            <div id="day3"></div><br>
            <div id="day4"></div><br>
            <div id="day5"></div><br>
            <script>
                var forecast = getForecast();
                var date = new Date(forecast.list[0].dt_txt);
                day1 = date.getDate();
                var max_temps = new Array(5);
                var min_temps = new Array(5);
                var days = new Array(5);
                var details = new Array(5);
                var texts = new Array(5);
                // Inicializa os vetores
                for(var i = 0; i < 5; i++) {
                    max_temps[i] = -100;
                    min_temps[i] = 100;
                    days[i] = 0;
                    details[i] = "";
                    texts[i] = "";
                }
                for(var i = 0; i < forecast.cnt; i++) {
                    date = new Date(forecast.list[i].dt_txt);
                    if(date.getDate() == day1) {
                        if(forecast.list[i].main.temp_max > max_temps[0])
                            max_temps[0] = forecast.list[i].main.temp_max;
                        if(forecast.list[i].main.temp_min < min_temps[0])
                            min_temps[0] = forecast.list[i].main.temp_min;
                        days[0] = new Date(forecast.list[i].dt_txt).getDay();
                        details[0] += date.getHours() + ":" + date.getMinutes() + " - " + getForecastStatus(forecast.list[i]) + ", " + getForecastTemp(forecast.list[i]) + "°C<br>";
                    } else if(date.getDate() == (day1 + 1)) {
                        if(forecast.list[i].main.temp_max > max_temps[1])
                            max_temps[1] = forecast.list[i].main.temp_max;
                        if(forecast.list[i].main.temp_min < min_temps[1])
                            min_temps[1] = forecast.list[i].main.temp_min;
                        days[1] = new Date(forecast.list[i].dt_txt).getDay();
                        details[1] += date.getHours() + ":" + date.getMinutes() + " - " + getForecastStatus(forecast.list[i]) + ", " + getForecastTemp(forecast.list[i]) + "°C<br>";
                    } else if(date.getDate() == (day1 + 2)) {
                        if(forecast.list[i].main.temp_max > max_temps[2])
                            max_temps[2] = forecast.list[i].main.temp_max;
                        if(forecast.list[i].main.temp_min < min_temps[2])
                            min_temps[2] = forecast.list[i].main.temp_min;
                        days[2] = new Date(forecast.list[i].dt_txt).getDay();
                        details[2] += date.getHours() + ":" + date.getMinutes() + " - " + getForecastStatus(forecast.list[i]) + ", " + getForecastTemp(forecast.list[i]) + "°C<br>";
                    } else if(date.getDate() == (day1 + 3)) {
                        if(forecast.list[i].main.temp_max > max_temps[3])
                            max_temps[3] = forecast.list[i].main.temp_max;
                        if(forecast.list[i].main.temp_min < min_temps[3])
                            min_temps[3] = forecast.list[i].main.temp_min;
                        days[3] = new Date(forecast.list[i].dt_txt).getDay();
                        details[3] += date.getHours() + ":" + date.getMinutes() + " - " + getForecastStatus(forecast.list[i]) + ", " + getForecastTemp(forecast.list[i]) + "°C<br>";
                    } else if(date.getDate() == (day1 + 4)) {
                        if(forecast.list[i].main.temp_max > max_temps[4])
                            max_temps[4] = forecast.list[i].main.temp_max;
                        if(forecast.list[i].main.temp_min < min_temps[4])
                            min_temps[4] = forecast.list[i].main.temp_min;
                        days[4] = new Date(forecast.list[i].dt_txt).getDay();
                        details[4] += date.getHours() + ":" + date.getMinutes() + " - " + getForecastStatus(forecast.list[i]) + ", " + getForecastTemp(forecast.list[i]) + "°C<br>";
                    }
                }
                texts[0] = "Hoje: <br>Temperatura Máxima: " + max_temps[0] + "°C" + "<br>Temperatura Mínima: " + min_temps[0] + "°C";
                texts[1] = "Amanhã: <br>Temperatura Máxima: " + max_temps[1] + "°C" + "<br>Temperatura Mínima: " + min_temps[1] + "°C";
                for(var i = 2; i < 5; i++) {
                    if(days[i] == 1)
                        texts[i] = "Domingo:<br>Temperatura Máxima: " + max_temps[i]+ "°C" + "<br>Temperatura Mínima: " + min_temps[i] + "°C";
                    else if(days[i] == 2)
                        texts[i] = "Segunda:<br>Temperatura Máxima: " + max_temps[i] + "°C" + "<br>Temperatura Mínima: " + min_temps[i] + "°C";
                    else if(days[i] == 3)
                        texts[i] = "Terça:<br>Temperatura Máxima: " + max_temps[i] + "°C" + "<br>Temperatura Mínima: " + min_temps[i] + "°C";
                    else if(days[i] == 4)
                        texts[i] = "Quarta:<br>Temperatura Máxima: " + max_temps[i] + "°C" + "<br>Temperatura Mínima: " + min_temps[i] + "°C";
                    else if(days[i] == 5)
                        texts[i] = "Quinta:<br>Temperatura Máxima: " + max_temps[i] + "°C" + "<br>Temperatura Mínima: " + min_temps[i] + "°C";
                    else if(days[i] == 6)
                        texts[i] = "Sexta:<br>Temperatura Máxima: " + max_temps[i] + "°C" + "<br>Temperatura Mínima: " + min_temps[i] + "°C";
                    else
                        texts[i] = "Sábado:<br>Temperatura Máxima: " + max_temps[i] + "°C" + "<br>Temperatura Mínima: " + min_temps[i] + "°C";
                }

                function expandDay(day) {
                    document.getElementById("day" + day).innerHTML = texts[day - 1] + "<br><button onClick='unexpandDay(" + (day) + ")'> Esconder </button><br>" + details[day - 1];
                }

                function unexpandDay(day) {
                    document.getElementById("day" + day).innerHTML = texts[day - 1] + "<br><button onClick='expandDay(" + (day) + ")'> Detalhes </button><br>";
                }

                for(var i = 0 ; i < 5; i ++) {
                    document.getElementById("day" + (i + 1)).innerHTML = texts[i] + "<br><button onClick='expandDay(" + (i+1) + ")'> Detalhes </button><br>";
                }
            </script>
        </section>
    </body>
</html>